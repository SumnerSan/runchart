---
title: "runchart Quickstart Guide"
author: "Joseph Adams"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{runchart Quickstart Guide}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Introduction

>Because they are simple to make and relatively straightforward to interpret, run charts are one of the most useful tools in quality improvement. - [NHS Scotland Quality Improvement Hub](http://www.qihub.scot.nhs.uk/knowledge-centre/quality-improvement-tools/run-chart.aspx).

Run charts^[As defined by the NHS Scotland Quality Improvement Hub] are non-trivial to automate. A number of solutions exist in the healthcare improvement community in Scotland. However the author is only aware of small-scale solutions such as scripts and Excel macros.

These kinds of approaches have the following limitations:

* Version control is cumbersome and unrealistic.
* Adding a separate script to an existing workflow is inconvenient and error prone.
* Scripts are often written to operate under specific conditions; making wider adoption unlikely.
* Testing edge cases is a time consuming task which is replicated with each new script or macro.

The `runchart` package aims to overcome these limitations by exporting a single, well tested, function of the same name: `runchart()`.

## Getting Started
To download the package first ensure you are not behind a firewall or using a VPN^[These can block installation from GitHub]. Install the package using `install_github()`^[You may need to install the `devtools` package first.]:

```
devtools::install_github('josephjosephadams/runchart')
```

The `runchart` package exports one simple function: `runchart()`. The only parameter is a numeric vector of non-zero length. It returns a data frame with 4 columns: `base`, `base_ext`, `shift`, and `val`.

For example:

```{r}
library(runchart)
rc <- runchart(c(0,1,5,2,3,8,2,2,3,4,7,4,3,4,2,3,1,2,3,2,8,9,7,8,7,9,NA,7,7,8,6,5))
rc
```

Code for plotting the result might look like this:

```{r, warning = FALSE, fig.width = 7, fig.align = 'center'}
library(ggplot2)
ggplot(rc, aes(1:nrow(rc), val)) +
  geom_line() +
  geom_line(aes(y = base), size = 1.3) +
  geom_line(aes(y = base_ext)) +
  geom_point(aes(y = shift), shape = 21, size = 3, colour = 'red',
             stroke = 2) +
  theme(axis.title.x=element_blank()) +
  theme(axis.title.y=element_blank())
```

## Things to Notice
There are several behaviours to notice in the plot above:

* **Rephasing** for each a sustained shift (9 consecutive points all above/below the baseline).

* **Shifts** are identified (6 or more consecutive points all above/below the baseline).

* **Missing values** are ignored. For example the 27th data point above is missing, which causes the rephased baseline to be shorter than the first.

* **Non-useful observations** are ignored. For example the 15th data point above lands exactly on the first baseline. Therefore it neither breaks nor contributes to the observed shift.

The `runchart()` function has been well tested to correctly handle such different scenarios and edge cases.
